<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Radex Wrapper Functions &mdash; SpectralRadex 0.1.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Radex" href="../tutorials/radex.html" />
    <link rel="prev" title="Spectral Modelling Functions" href="spectralradex.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> SpectralRadex
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/formalism.html">Formalism</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/referencing.html">Referencing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/trouble.html">Trouble Shooting</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="spectralradex.html">Spectral Modelling Functions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Radex Wrapper Functions</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/radex.html">Radex</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/spectralmodelling.html">Spectral Modelling</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SpectralRadex</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Radex Wrapper Functions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/radex.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-spectralradex.radex">
<span id="radex-wrapper-functions"></span><span id="radex"></span><h1>Radex Wrapper Functions<a class="headerlink" href="#module-spectralradex.radex" title="Permalink to this headline"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="spectralradex.radex.run">
<span class="sig-prename descclassname"><span class="pre">spectralradex.radex.</span></span><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectralradex.radex.run" title="Permalink to this definition"></a></dt>
<dd><p>Run a single RADEX model using a dictionary to set parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> (<em>dict</em>) – A dictionary containing the RADEX inputs that the user wishes to set,
all other parameters will use the default values. See <a class="reference internal" href="#spectralradex.radex.get_default_parameters" title="spectralradex.radex.get_default_parameters"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_default_parameters()</span></code></a>
for a list of possible parameters and <a class="reference internal" href="#spectralradex.radex.run_params" title="spectralradex.radex.run_params"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_params()</span></code></a> for descriptions.</p></li>
<li><p><strong>output_file</strong> (<em>str</em>) – If not <code class="docutils literal notranslate"><span class="pre">None</span></code>, the RADEX results are stored to this file in csv format/</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectralradex.radex.run_params">
<span class="sig-prename descclassname"><span class="pre">spectralradex.radex.</span></span><span class="sig-name descname"><span class="pre">run_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tkin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cdmol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nh2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ne</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nhe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nhx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tbg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.73</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geometry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectralradex.radex.run_params" title="Permalink to this definition"></a></dt>
<dd><p>Run a single RADEX model from individual parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molfile</strong> (<em>float</em>) – Either a full path or a relative path beginning with “.” to a datafile in the Lamda database
format. Alternatively, the filename of a datafile from <cite>list_data_files()</cite>.</p></li>
<li><p><strong>tkin</strong> – Temperature of the Gas in Kelvin</p></li>
<li><p><strong>cdmol</strong> – Column density of the emitting species in cm <span class="math notranslate nohighlight">\(^{-2}\)</span></p></li>
<li><p><strong>nh</strong> (<em>float</em><em>, </em><em>optional</em>) – Number density of H atoms</p></li>
<li><p><strong>nh2</strong> (<em>float</em><em>, </em><em>optional</em>) – Total number density of H2 molecules, set this to o-H2 + p-H2 if using ortho and para H2 as collisional partners.</p></li>
<li><p><strong>op_ratio</strong> (<em>float</em><em>, </em><em>optional</em>) – Ortho to para ratio for H2. Defaults to statistical limit of 3 and used to set o-H2 and p-H2 densities from nh2.</p></li>
<li><p><strong>ne</strong> (<em>float</em><em>, </em><em>optional</em>) – Number density of electron.</p></li>
<li><p><strong>nhe</strong> (<em>float</em><em>, </em><em>optional</em>) – Number density of He atoms.</p></li>
<li><p><strong>nhx</strong> – Number density of H+ ions.</p></li>
<li><p><strong>linewidth</strong> (<em>float</em><em>, </em><em>optional</em>) – FWHM of the line in km s <span class="math notranslate nohighlight">\(^{-1}\)</span>.</p></li>
<li><p><strong>fmin</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum frequency below which a line is not included in the results.</p></li>
<li><p><strong>fmax</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum frequency above which a line is not included in the results.</p></li>
<li><p><strong>tbg</strong> (<em>float</em><em>, </em><em>optional</em>) – Background temperature, defaults to CMB temperature 2.73 K.</p></li>
<li><p><strong>geometry</strong> (<em>int</em><em>, </em><em>optional</em>) – Choice of geometry of emitting object. 1 for sphere, 2 for LVG, 3 for slab.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectralradex.radex.run_grid">
<span class="sig-prename descclassname"><span class="pre">spectralradex.radex.</span></span><span class="sig-name descname"><span class="pre">run_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'FLUX</span> <span class="pre">(K*km/s)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectralradex.radex.run_grid" title="Permalink to this definition"></a></dt>
<dd><p>Runs a grid of RADEX models using all combinations of any iterable items in the parameters dictionary whilst keeping other parameters constant. Returns a dataframe of results and can be parallelized with the <code class="docutils literal notranslate"><span class="pre">pool</span></code> parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> – A dictionary of parameters as provided by <a class="reference internal" href="#spectralradex.radex.get_default_parameters" title="spectralradex.radex.get_default_parameters"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_default_parameters()</span></code></a> or <a class="reference internal" href="#spectralradex.radex.get_example_grid_parameters" title="spectralradex.radex.get_example_grid_parameters"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_example_grid_parameters()</span></code></a>. Parameters should take a single value when they are constant over the grid and contain and interable if they are to be varied.</p></li>
<li><p><strong>molfile</strong> (<em>str</em>) – Either a full path or a relative path beginning with “.” to a datafile in the Lamda database
format. Alternatively, the filename of a datafile from <cite>list_data_files()</cite>.</p></li>
<li><p><strong>target_value</strong> (<em>str</em><em>,</em><em>optional</em>) – RADEX output column to be returned. Select one of ‘T_R (K)’, ‘FLUX (K*km/s)’, ‘FLUX (erg/cm2/s)’</p></li>
<li><p><strong>pool</strong> (<em>Pool</em><em>, </em><em>optional</em>) – a Pool object with <code class="docutils literal notranslate"><span class="pre">map()</span></code>, <code class="docutils literal notranslate"><span class="pre">close()</span></code> , and <code class="docutils literal notranslate"><span class="pre">join()</span></code> methods such as multiprocessing.Pool or schwimmbad.MPIPool.
If supplied, the grid will be calculated in parallel.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectralradex.radex.get_default_parameters">
<span class="sig-prename descclassname"><span class="pre">spectralradex.radex.</span></span><span class="sig-name descname"><span class="pre">get_default_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#spectralradex.radex.get_default_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Get the default RADEX parameters as a dictionary, this largely serves as an example for the
input required for <a class="reference internal" href="#spectralradex.radex.run" title="spectralradex.radex.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">run()</span></code></a>.</p>
<p>molfile should be a collsional datafile in the LAMDA database format. If using a local file, a full path or a relative path  beginning with “.” is required. Otherwise, one of the files listed by <a class="reference internal" href="#spectralradex.radex.list_data_files" title="spectralradex.radex.list_data_files"><code class="xref py py-func docutils literal notranslate"><span class="pre">list_data_files()</span></code></a> can be supplied without a path.</p>
<p>method is 1 (uniform sphere), 2 (LVG), or 3 (slab)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectralradex.radex.get_example_grid_parameters">
<span class="sig-prename descclassname"><span class="pre">spectralradex.radex.</span></span><span class="sig-name descname"><span class="pre">get_example_grid_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#spectralradex.radex.get_example_grid_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Returns a dictionary of parameters for RADEX with iterables which can be used with <a class="reference internal" href="#spectralradex.radex.run_grid" title="spectralradex.radex.run_grid"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_grid()</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectralradex.radex.get_transition_table">
<span class="sig-prename descclassname"><span class="pre">spectralradex.radex.</span></span><span class="sig-name descname"><span class="pre">get_transition_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molfile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectralradex.radex.get_transition_table" title="Permalink to this definition"></a></dt>
<dd><p>Reads a collisional data file and returns a pandas DataFrame for the molecule with one row per transition containing the Einstein coefficients, upper level energy and frequency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>molfile</strong> (<em>str</em>) – Either the full path to a collisional datafile or the filename of one supplied with SpectralRadex</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectralradex.radex.get_collisional_partners">
<span class="sig-prename descclassname"><span class="pre">spectralradex.radex.</span></span><span class="sig-name descname"><span class="pre">get_collisional_partners</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molfile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectralradex.radex.get_collisional_partners" title="Permalink to this definition"></a></dt>
<dd><p>Reads a collisional data file and returns a dictionary containing the number of collisional partners and their names. The partner names match the input keys for <a class="reference internal" href="#spectralradex.radex.run" title="spectralradex.radex.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">run()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>molfile</strong> (<em>str</em>) – Either the full path to a collisional datafile or the filename of one supplied with SpectralRadex</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectralradex.radex.thermal_h2_op_ratio">
<span class="sig-prename descclassname"><span class="pre">spectralradex.radex.</span></span><span class="sig-name descname"><span class="pre">thermal_h2_op_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tkin</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spectralradex.radex.thermal_h2_op_ratio" title="Permalink to this definition"></a></dt>
<dd><p>If your data file has collisions with p-h2 and o-h2 but you only provide the h2 density, RADEX
splits the h2 density according to the thermal ortho:para ratio. You can check that value for any
given temperature with this function. Returns the ortho:para ratio as a float</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tkin</strong> (<em>float</em>) – Gas kinetic temperature</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spectralradex.radex.list_data_files">
<span class="sig-prename descclassname"><span class="pre">spectralradex.radex.</span></span><span class="sig-name descname"><span class="pre">list_data_files</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#spectralradex.radex.list_data_files" title="Permalink to this definition"></a></dt>
<dd><p>SpectralRadex is packaged with a selection of LAMDA collisional datafiles.
This function prints the list of available files. You can provide the full path to another
file in the parameter dictionary to use one not packaged with SpectralRadex.</p>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="spectralradex.html" class="btn btn-neutral float-left" title="Spectral Modelling Functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../tutorials/radex.html" class="btn btn-neutral float-right" title="Radex" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Jonathan Holdship.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>